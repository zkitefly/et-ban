version: '3.8'

services:
  easytier:
    image: easytier/easytier:latest
    container_name: easytier
    network_mode: host
    restart: unless-stopped
    # 如果需要特定配置，可以添加环境变量或卷挂载
    # environment:
    #   - EASYTIER_CONFIG=...
    # volumes:
    #   - ./easytier-config:/etc/easytier

  proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: tcp-proxy
    environment:
      - LISTEN_PORT=11221
      - TARGET_HOST=0.0.0.0
      - TARGET_PORT=11010
      - GEOIP_DB_PATH=/usr/share/GeoIP/GeoLite2-Country.mmdb
    network_mode: host
    restart: unless-stopped
    depends_on:
      - easytier
